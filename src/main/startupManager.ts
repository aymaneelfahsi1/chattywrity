import { app } from 'electron';import * as path from 'path';const Registry = require('winreg');export class StartupManager {    private appName: string;    private regKey: any;    constructor(appName: string) {        this.appName = appName;        this.regKey = new Registry({            hive: Registry.HKCU,            key: '\\Software\\Microsoft\\Windows\\CurrentVersion\\Run'        });    }    isEnabled(): boolean {        return new Promise<boolean>((resolve) => {            this.regKey.get(this.appName, (err: Error | null, item: any) => {                if (err || !item) {                    resolve(false);                } else {                    resolve(true);                }            });        }) as unknown as boolean;    }    async isEnabledAsync(): Promise<boolean> {        return new Promise((resolve) => {            this.regKey.get(this.appName, (err: Error | null, item: any) => {                resolve(!err && !!item);            });        });    }    enable(): Promise<void> {        return new Promise((resolve, reject) => {            const exePath = app.isPackaged                ? process.execPath                : path.join(__dirname, '../../node_modules/.bin/electron.cmd');            const appPath = app.isPackaged                ? `"${exePath}"`                : `"${exePath}" "${path.join(__dirname, '../../')}"`;            this.regKey.set(this.appName, Registry.REG_SZ, appPath, (err: Error | null) => {                if (err) {                    reject(err);                } else {                    resolve();                }            });        });    }    disable(): Promise<void> {        return new Promise((resolve, reject) => {            this.regKey.remove(this.appName, (err: Error | null) => {                if (err) {                    reject(err);                } else {                    resolve();                }            });        });    }}